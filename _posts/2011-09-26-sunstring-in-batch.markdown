---
layout: post
category : Windows
tags : [substring, batch, Windows]
title: 批处理截取字符串方法详解
wordpress_id: 1008
wordpress_url: http://www.im47.cn/?p=1008
date: 2011-09-26 21:21:54.000000000 +08:00
---
@echo off
set str=123456789
echo 第一个字符为：%str:~0,1%
echo 头两个字符为：%str:~0,2%
echo 头5个字符为：%str:~0,5%
echo 去掉最后一个字符后的字符串为：%str:~0,-1%
echo 去掉最后3个字符后的字符串为：%str:~0,-3%
echo 第4个字符为：%str:~3,1%
echo 第4个及其之后的3个字符为：%str:~3,4%
echo 最后一个字符为：%str:~-1%
echo 最后一个字符为：%str:~-1,1%
echo 最后一个字符为：%str:~-1,2%
echo 倒数第4个字符为：%str:~-4,1%
echo 倒数第4个及其之后的字符为：%str:~-4%
echo 倒数第4个及其之后的1个字符为：%str:~-4,2%
echo 倒数第4个及其之后的2个字符为：%str:~-4,3%
pause

echo %var:~n,k% 
我们在这里对每个参数做个说明:"%var",即我们要从中要截取字符的字符串." ~ "取字符标志符(我是这么理解的),"n" 我们将其理解为指针,"k"我们将其理解为偏移地址.(注:指针和偏移地址都是从零开始数的)

@echo off
set str=123456789

rem 定义一个str字符串为123456789
echo 第一个字符为：%str:~0,1%

rem 指针为0,偏移地址为1,即从第0位开始,取1位
echo 头两个字符为：%str:~0,2%

rem 指针为0,偏移地址为2,即从第0位开始,取2位
echo 头5个字符为：%str:~0,5%

rem 指针为0,偏移地址为5,即从第0位开始,取5位
echo 去掉最后一个字符后的字符串为：%str:~0,-1%

rem 当"k"为负值时,我们可以这样理解:从指针开始处开始取其后面所有字符,然后减去后面"abs(k)位"..所以这个句字我们可以做如下解释:从第0位开始取其全部字符为:123456789然后从后面减去abs(k)位,所以最后结果为:12345678
echo 去掉最后3个字符后的字符串为：%str:~0,-3%

rem 该句解释同上
echo 最后一个字符为：%str:~-1%

rem 参数"n,"和"k"都可以为缺省,缺省"n,"时可以理解为:从abs(k)位开始取其全部
echo 倒数第4个及其之后的字符为：%str:~-4%

rem 解释同上
echo 最后一个字符为：%str:~-1,1%

rem n为负值时,表示从后面开始截取字符,取k位(此时n应从1开始数)
echo 最后一个字符为：%str:~-1,2%

rem 解释同上
echo 倒数第4个字符为：%str:~-4,1%

rem 解释同上
echo 倒数第4个及其之后的1个字符为：%str:~-4,2%

rem 解释同上
echo 倒数第4个及其之后的2个字符为：%str:~-4,3%

rem 解释同上
pause
